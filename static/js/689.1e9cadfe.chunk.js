"use strict";(self.webpackChunkgraphwear=self.webpackChunkgraphwear||[]).push([[689],{5689:(e,t,a)=>{a.r(t),a.d(t,{default:()=>y});var s=a(5043),r=a(5472),l=a(791),o=a(522),n=a(579);const i=e=>{let{children:t,header:a=" ",onEdit:s,isDisable:r=!1,disableReason:l="Not Allowed"}=e;return(0,n.jsxs)("div",{className:"w-full bg-white px-4 md:px-8 rounded-xl",children:[a&&(0,n.jsxs)("div",{className:"flex items-end gap-[5px] mb-8",children:[(0,n.jsx)("h2",{className:"font-bold text-xl md:text-2xl",children:a}),s&&(0,n.jsx)("p",{className:"text-xl font-bold "+(r?"cursor-not-allowed text-gray-500":"cursor-pointer text-accent hover:text-amber-700 duration-100"),onClick:r?()=>{}:s,title:r?l:"",children:"(edit)"})]}),t]})};var c=a(3969),d=a(6677),m=a(9067),x=a(3238),h=a(6196),u=a(8688),f=a(6185),p=a(6711),b=a(2807),j=a(446),v=a.n(j),g=a(3216),w=a(9928);(0,w.A)({components:{MuiIconButton:{styleOverrides:{root:{"& .MuiSvgIcon-root":{color:"#ffffff !important"},"&:hover .MuiSvgIcon-root":{color:"#ffffff !important"},"&.Mui-active .MuiSvgIcon-root":{color:"#ffffff !important"}}}},MuiTableSortLabel:{styleOverrides:{root:{"& .MuiSvgIcon-root":{color:"#ffffff !important"},"&:hover .MuiSvgIcon-root":{color:"#ffffff !important"},"&.Mui-active .MuiSvgIcon-root":{color:"#ffffff !important"}}}}}}),(0,w.A)({components:{MuiIconButton:{styleOverrides:{root:{"& .MuiSvgIcon-root":{color:"#707070 !important"}}}},MuiTableSortLabel:{styleOverrides:{root:{"& .MuiSvgIcon-root":{color:"#707070 !important"},"&:hover .MuiSvgIcon-root":{color:"#ffffff !important"},"&.Mui-active .MuiSvgIcon-root":{color:"#707070 !important"}}}}}});const N=(e,t)=>{if(!t.length)return;const a=Object.keys(t[0]),s=t.map((e=>a.map((t=>{var a;return JSON.stringify(null!==(a=e[t])&&void 0!==a?a:"")})))),r=[a,...s].map((e=>e.join(","))).join("\n"),l=new Blob([r],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a");o.href=URL.createObjectURL(l),o.setAttribute("download",`${e}_data.csv`),document.body.appendChild(o),o.click(),document.body.removeChild(o)};var S=a(5263);const y=()=>{const{users:e}=(0,g.KC)(),[t,a]=(0,s.useState)(!0),[j,w]=(0,s.useState)(!1),[y,M]=(0,s.useState)([]),[A,I]=(0,s.useState)([]),[k,C]=(0,s.useState)(["Sensor 1","Sensor 2"]),[D,_]=(0,s.useState)([]);(0,s.useEffect)((()=>{if(!A)return;let e;if(A.length>0){0===D.length&&_(k),a(!0);const t=(0,r.P)((0,r.rJ)(l.db,"lactate_data"),(0,r._M)("user_name","in",A.slice(0,10)));e=(0,r.aQ)(t,(e=>{let t=[];e.forEach((e=>{const a=e.data();"number"===typeof a.timestamp&&(a.timestamp=new Date(1e3*a.timestamp).toISOString()),t.push(a)})),t=t.filter((e=>D.includes(e.sensor_id))),t.sort(((e,t)=>new Date(e.timestamp)-new Date(t.timestamp))),M(t),w(!1),a(!1)}),(e=>{console.error("Error fetching filtered data:",e),w(!0),a(!1)}))}return a(!1),()=>{e&&e()}}),[A,D]);const Y=(e,t)=>y.filter((t=>t.sensor_id===e)).map((e=>e[t])),L=e=>y.filter((t=>t.sensor_id===e)).map((e=>new Date(e.timestamp)));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"py-8 flex flex-col space-y-2 md:items-baseline md:flex-row md:justify-between",children:(0,n.jsx)("h1",{className:"text-2xl md:text-3xl font-bold",children:"Sensor Data Charts"})}),(0,n.jsxs)(c.A,{className:"w-full flex items-center justify-between mb-4 flex-wrap gap-4",children:[(0,n.jsxs)("div",{className:"flex gap-4 flex-wrap",children:[(0,n.jsxs)(d.A,{sx:{minWidth:250},children:[(0,n.jsx)(m.A,{children:"User Name"}),(0,n.jsx)(x.A,{value:A,onChange:e=>I([e.target.value]),input:(0,n.jsx)(h.A,{label:"User Name"}),renderValue:e=>e.join(", "),children:e.map((e=>(0,n.jsx)(u.A,{value:e,children:(0,n.jsx)(f.A,{primary:e})},e)))})]}),A.length>0&&(0,n.jsxs)(d.A,{sx:{minWidth:250},children:[(0,n.jsx)(m.A,{children:"Sensor ID"}),(0,n.jsx)(x.A,{multiple:!0,value:D,onChange:e=>_(e.target.value),input:(0,n.jsx)(h.A,{label:"Sensor ID"}),renderValue:e=>e.join(", "),children:k.map((e=>(0,n.jsxs)(u.A,{value:e,children:[(0,n.jsx)(p.A,{checked:D.includes(e)}),(0,n.jsx)(f.A,{primary:e})]},e)))})]})]}),(0,n.jsx)("button",{onClick:()=>{N("combined_sensor_data",y)},className:"text-sm bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md",children:"Download User Data"})]}),t?(0,n.jsx)(i,{children:(0,n.jsx)(o.k,{size:"40px",className:"h-[223px]"})}):j?(0,n.jsx)(i,{children:(0,n.jsx)("p",{className:"text-red-500",children:"Failed to load data."})}):0===A.length||0===D.length?(0,n.jsx)(i,{children:(0,n.jsx)("p",{className:"text-black text-lg pb-10",children:"\ud83d\udc4b Select a user to view sensor data."})}):(0,n.jsx)(i,{children:D.map((e=>{var t,a,r;const l=y.filter((t=>t.sensor_id===e)).at(-1),o=y.filter((t=>t.sensor_id===e));return(0,n.jsxs)(s.Fragment,{children:[(0,n.jsxs)("div",{className:"mt-10 mb-4",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("h2",{className:"text-2xl font-semibold text-Black-400 pb-4",children:e}),(0,n.jsx)(S.WCW,{className:"cursor-pointer",onClick:()=>N(e,o)})]}),l&&(0,n.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-gray-700 pb-2 border-b",children:[(0,n.jsxs)("p",{children:["Temperature:",(0,n.jsx)("b",{className:"pl-2",children:l.temperature})]}),(0,n.jsxs)("p",{children:["Connection Status:",(0,n.jsx)("b",{className:"pl-2",children:`${l.connection_status_flag}`})]}),(0,n.jsxs)("p",{children:["Wear Status:",(0,n.jsx)("b",{className:"pl-2",children:`${l.wearing_status_flag}`})]})]})]}),(0,n.jsx)("div",{className:"w-full overflow-x-auto",children:(0,n.jsx)("div",{className:"min-w-[800px]",children:(0,n.jsx)(b.b,{margin:{left:0,top:20,right:20,bottom:30},height:300,series:[{data:Y(e,"ohm1"),label:"Lactate",showMark:!1}],xAxis:[{scaleType:"time",data:L(e)}],tooltip:{valueFormatter:(t,a)=>`Time: ${v()(void 0!==a.dataIndex?L(e)[a.dataIndex]:"").format("YYYY-MM-DD HH:mm:ss")}`}})})}),(0,n.jsxs)("h3",{className:"text-lg text-black mt-8 pb-4 text-center",children:[(0,n.jsx)("b",{children:"Lactate (Channel 1)"})," : ",(0,n.jsx)("b",{className:"pb-4 text-green-600",children:null!==(t=null===l||void 0===l?void 0:l.ohm1)&&void 0!==t?t:""})]}),(0,n.jsx)("hr",{className:"border-t border-gray-300 my-8 w-full"}),(0,n.jsx)("div",{className:"w-full overflow-x-auto",children:(0,n.jsx)("div",{className:"min-w-[800px]",children:(0,n.jsx)(b.b,{margin:{left:0,top:20,right:20,bottom:30},height:300,series:[{data:Y(e,"ohm3"),label:"Lactate",showMark:!1}],xAxis:[{scaleType:"time",data:L(e)}],tooltip:{valueFormatter:(t,a)=>`Time: ${v()(void 0!==a.dataIndex?L(e)[a.dataIndex]:"").format("YYYY-MM-DD HH:mm:ss")}`}})})}),(0,n.jsxs)("h3",{className:"text-lg text-black mt-8 pb-4 text-center",children:[(0,n.jsx)("b",{children:"Lactate (Channel 2)"})," : ",(0,n.jsx)("b",{className:"pb-4 text-green-600",children:null!==(a=null===l||void 0===l?void 0:l.ohm1)&&void 0!==a?a:""})]}),(0,n.jsx)("hr",{className:"border-t border-gray-300 my-8 w-full"}),(0,n.jsx)("div",{className:"w-full overflow-x-auto",children:(0,n.jsx)("div",{className:"min-w-[800px]",children:(0,n.jsx)(b.b,{margin:{left:0,top:20,right:20,bottom:30},height:300,series:[{data:Y(e,"ohm3"),label:"Lactate",showMark:!1}],xAxis:[{scaleType:"time",data:L(e)}],tooltip:{valueFormatter:(t,a)=>`Time: ${v()(void 0!==a.dataIndex?L(e)[a.dataIndex]:"").format("YYYY-MM-DD HH:mm:ss")}`}})})}),(0,n.jsxs)("h3",{className:"text-lg text-black mt-8 pb-4 text-center",children:[(0,n.jsx)("b",{children:"Lactate (Channel 3)"})," : ",(0,n.jsx)("b",{className:"pb-4 text-green-600",children:null!==(r=null===l||void 0===l?void 0:l.ohm1)&&void 0!==r?r:""})]})]},e)}))})]})}}}]);
//# sourceMappingURL=689.1e9cadfe.chunk.js.map